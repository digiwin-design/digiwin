'use strict';

// Vue.use(VueAwesomeSwiper);
var store = new Vuex.Store({
    state: {
        isMobile: false,
        isMediumWidth: false,
        result: null
    },
    mutations: {
        updateDevice: function updateDevice(state, payload) {
            state.isMobile = payload;
        },
        updateDevice2: function updateDevice2(state, payload) {
            state.isMediumWidth = payload;
        },
        setData: function setData(state, payload) {
            state.result = payload;
        }
    },
    actions: {
        getData: function getData(context) {
            axios.get('db.json').then(function (res) {
                context.commit('setData', res.data);
                app.$nextTick(function () {
                    // 依據選單高度設定main上方間距
                    var menuHeight = document.querySelector('.page-submenu') && document.querySelector('.page-submenu').offsetHeight;
                    document.querySelector('main').style.paddingTop = menuHeight > 50 ? '50px' : 0;
                    app.initProblemList();
                });
            });
        }
    }
});
var app = new Vue({
    el: 'main',
    computed: {
        isMobile: function isMobile() {
            return store.state.isMobile;
        },
        isMediumWidth: function isMediumWidth() {
            return store.state.isMediumWidth;
        },
        result: function result() {
            return store.state.result;
        }
    },
    methods: {
        mediaSensor: function mediaSensor(minWidth) {
            var resizeWidth = function resizeWidth(pMatchMedia) {
                return store.commit('updateDevice', !pMatchMedia.matches);
            };

            var mm = window.matchMedia('(min-width: '.concat(minWidth + 1, 'px)'));
            mm.addListener(resizeWidth);
            resizeWidth(mm);
        },
        mediaSensor2: function mediaSensor2(minWidth) {
            var resizeWidth = function resizeWidth(pMatchMedia) {
                return store.commit('updateDevice2', !pMatchMedia.matches);
            };

            var mm = window.matchMedia('(min-width: '.concat(minWidth + 1, 'px)'));
            mm.addListener(resizeWidth);
            resizeWidth(mm);
        },
        initProblemList: function initProblemList() {
            $('.problemList').each(function () {
                var $this = $(this);
                var thisPercent = parseFloat($this.children('.digital').text().substr(0, 4)) * 10;
                var problemListW = Math.round(490 * thisPercent / 672);
                $this.animate({
                    width: problemListW
                }, {
                    duration: 2500,
                    easing: 'easeInOutCubic',
                    complete: function complete() {
                        $('.digital').fadeIn();
                    }
                });
            });
        }
    },
    created: function created() {
        store.dispatch('getData');
    },
    mounted: function mounted() {
        this.mediaSensor(768);
        this.mediaSensor2(1199);
    }
});