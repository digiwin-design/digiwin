"use strict";new Vue({el:".list-case-show",data:{displayName:"",pictureUrl:""},computed:{channelID:function(){return"1563584152"},channelSecret:function(){return"784af891734ae5e34c4b8ea5c382410c"},state:function(){return"abcde"},callbackUrl:function(){return location.origin+location.pathname}},methods:{getParameterByName:function(e,t){t||(t=location.href),e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),n=o.exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},login:function(){var e="https://access.line.me/oauth2/v2.1/authorize?";e+="response_type=code",e+="&client_id="+this.channelID,e+="&redirect_uri="+this.callbackUrl,e+="&state="+this.state,e+="&scope=openid%20email%20profile",location.href=e},logout:function(){localStorage.removeItem("lineToken"),location.reload()},checkLogin:function(){return localStorage.getItem("lineToken")},getCode:function(){var e=this.getParameterByName("code",location.href),t=this.getParameterByName("state",location.href);if(e&&t===this.state){var o=this.callbackUrl.split("/").pop();return history.replaceState({},"",o),void this.getToken(e)}this.showCover()},getToken:function(e){var t=this,o=new URLSearchParams;o.append("grant_type","authorization_code"),o.append("code",e),o.append("redirect_uri",this.callbackUrl),o.append("client_id",this.channelID),o.append("client_secret",this.channelSecret),axios.post("https://api.line.me/oauth2/v2.1/token",o).then(function(e){return 200!==e.status?t.showCover():(t.accessToken=e.data.access_token,localStorage.setItem("lineToken",t.accessToken),void t.getProfile(t.accessToken))})["catch"](function(e){return t.showCover()})},getProfile:function(e){var t=this;axios.get("https://api.line.me/v2/profile",{headers:{Authorization:"Bearer "+e}}).then(function(e){return 200!==e.status?t.showCover():(t.displayName=e.data.displayName,t.pictureUrl=e.data.pictureUrl,void console.log("login.."))})["catch"](function(e){return t.showCover()})},showCover:function(){this.$el.offsetHeight>1400&&(this.$el.style.height="1400px",this.$el.style.overflow="hidden"),this.$el.classList.add("no-login"),console.log("no login..")},addCover:function(){$(".list-case-show").append('<div class="articleCover">\n                    <a href @click.prevent="login">登入看更多</a>\n                </div>'),$(".list-case-show").prepend('<button @click="logout" style="position: fixed;left: 0;bottom: 0;z-index: 1;">登出</button>')}},created:function(){this.addCover()},mounted:function(){var e=this.checkLogin();return e?void this.getProfile(e):void this.getCode()}});
//# sourceMappingURL=lineMember.min.js.map
